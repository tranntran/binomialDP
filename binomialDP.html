<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>binomialDP: Differentially Private Inference for Binomial Data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">binomialDP: Differentially Private Inference for Binomial Data</h1>


<div id="TOC">
<ul>
<li><a href="#the-truncated-uniform-laplace-tulap-distrubution">The Truncated-Uniform-Laplace (Tulap) Distrubution</a></li>
<li><a href="#simulated-data">Simulated Data</a></li>
<li><a href="#differentially-private-uniformly-most-powerful-tests-dp-ump">Differentially Private Uniformly Most Powerful Tests (DP-UMP)</a><ul>
<li><a href="#simple-and-one-sided-dp-ump-tests">Simple and One-Sided DP-UMP Tests</a></li>
<li><a href="#unbiased-two-sided-dp-ump-tests">Unbiased Two-Sided DP-UMP Tests</a></li>
<li><a href="#asymptotically-unbiased-two-sided-dp-ump-tests">Asymptotically Unbiased Two-Sided DP-UMP Tests</a></li>
</ul></li>
<li><a href="#p-values">p-Values</a><ul>
<li><a href="#ump-one-sided-p-values">UMP One-Sided p-Values</a></li>
<li><a href="#asymptotically-unbiased-dp-p-values">Asymptotically Unbiased DP p-Values</a></li>
<li><a href="#comparing-private-and-non-private-p-values">Comparing Private and Non-Private p-values</a></li>
</ul></li>
<li><a href="#confidence-intervals">Confidence Intervals</a><ul>
<li><a href="#one-sided-confidence-intervals">One-sided Confidence Intervals</a></li>
<li><a href="#asymptotically-unbiased-two-sided-confidence-intervals">Asymptotically Unbiased Two-sided Confidence Intervals</a></li>
</ul></li>
<li><a href="#comparing-differentially-private-and-non-private-population-proportion-test">Comparing Differentially Private and Non-Private Population Proportion Test</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p><code>binomialDP</code> package aids the process of analyzing differentially private (DP) data by offering a tool to perform statistical inference on differentially private binomial data. This package includes functions for the Tulap distributions, DP-UMP tests, private p-values, and private confidence intervals for binomial data.</p>
<div id="the-truncated-uniform-laplace-tulap-distrubution" class="section level2">
<h2>The Truncated-Uniform-Laplace (Tulap) Distrubution</h2>
<p>The distribution <span class="math inline">\(\small Tulap(m, b, 0)\)</span> is obtained by adding discrete Laplace noise <span class="math inline">\(\small L \sim DLap(e^{-\epsilon})\)</span> and continuous uniform noise <span class="math inline">\(\small U \sim Unif(-1/2, 1/2)\)</span> to the value m. The distribution <span class="math inline">\(\small Tulap(m,b,q)\)</span> is obtained by truncating between the <span class="math inline">\(\small (q/2)^{th}\)</span> and the <span class="math inline">\(\small (1-q/2)^{th}\)</span> quantiles of the <span class="math inline">\(\small Tulap(m,b,0)\)</span> distribution.</p>
<p>Similar to other distribution functions, the <code>ptulap()</code> function gives the distribution function, and <code>rtulap()</code> generates random sample from this distribution. For example, to sample 10,000 observations from Tulap distribution, with the median of 30, <span class="math inline">\(\small b = e^{-1}\)</span>, and <span class="math inline">\(\small q = 0.06\)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(binomialDP)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; binomialDP: Differentially Private Inference for Binomial Data</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; To get started, use help(package = &#39;binomialDP&#39;) or vignette(&#39;binomialDP&#39;, package = &#39;binomialDP&#39;).</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt; For citation information, use citation(&#39;binomialDP&#39;).</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">set.seed</span>(<span class="dv">1001</span>)</a>
<a class="sourceLine" id="cb1-6" title="6">rand =<span class="st"> </span><span class="kw">rtulap</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">m =</span> <span class="dv">30</span>, <span class="dt">b =</span> <span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>), <span class="dt">q =</span> <span class="fl">0.06</span>)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">plot</span>(<span class="kw">density</span>(rand), <span class="dt">main =</span> <span class="st">&quot;Random Sample of 10000 </span><span class="ch">\n</span><span class="st"> from Tulap Distribution&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Value&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The figure confirms that a Tulap random variable is continuous and symmetric around the median. When q = 0, the distribution is not truncated.</p>
</div>
<div id="simulated-data" class="section level2">
<h2>Simulated Data</h2>
<p>First, we obtain the original data set by sampling from the binomial distribution with <code>rbinom()</code>. Then, we make it differentially private by adding noise from the Tulap distribution through the function <code>rtulap()</code>. The latter data is the data we will perform statistical testing on.</p>
<p>Let <span class="math inline">\(\small X \sim Bin(n,\theta)\)</span> where <span class="math inline">\(\small n = 30\)</span> and <span class="math inline">\(\small \theta = 0.4\)</span>, but the value of <span class="math inline">\(\small \theta\)</span> is supposed to be unknown. Also, with <span class="math inline">\(\small \epsilon = 1\)</span> and <span class="math inline">\(\small \delta = 0.01\)</span>, we obtain: <span class="math display">\[\small b = e^{-\epsilon} = e^{-1} ~~~~~~~~~~~~~~~~~~ q = \frac{2\delta b}{1-b+2\delta b} = \frac{2(0.01)e^{-1}}{1-e^{-1}+2(0.01)e^{-1}}\]</span></p>
<p>We obtain the differentially private binomial data <span class="math inline">\(\small Z\)</span> by adding noise from <span class="math inline">\(\small Tulap(0,b,q)\)</span> distribution to the original data. <span class="math inline">\(\small Z|X\sim Tulap(X,b,q)\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1001</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#set up the parameters</span></a>
<a class="sourceLine" id="cb2-3" title="3">n =<span class="st"> </span><span class="dv">30</span>                      <span class="co">#number of trials</span></a>
<a class="sourceLine" id="cb2-4" title="4">truth =<span class="st"> </span><span class="fl">0.4</span>                 <span class="co">#true theta</span></a>
<a class="sourceLine" id="cb2-5" title="5">reps =<span class="st"> </span><span class="dv">100000</span>               <span class="co">#sample size</span></a>
<a class="sourceLine" id="cb2-6" title="6">ep =<span class="st"> </span><span class="dv">1</span>                      <span class="co">#epsilon</span></a>
<a class="sourceLine" id="cb2-7" title="7">de =<span class="st"> </span><span class="fl">0.01</span>                   <span class="co">#delta</span></a>
<a class="sourceLine" id="cb2-8" title="8">b =<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>ep)                <span class="co">#b</span></a>
<a class="sourceLine" id="cb2-9" title="9">q =<span class="st"> </span><span class="dv">2</span><span class="op">*</span>de<span class="op">*</span>b<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>b<span class="op">+</span><span class="dv">2</span><span class="op">*</span>de<span class="op">*</span>b)     <span class="co">#q</span></a>
<a class="sourceLine" id="cb2-10" title="10">alpha =<span class="st"> </span><span class="fl">0.05</span>                <span class="co">#level alpha</span></a>
<a class="sourceLine" id="cb2-11" title="11"></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#create the orginal data though binomial simulation</span></a>
<a class="sourceLine" id="cb2-13" title="13">X =<span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">n =</span> reps, <span class="dt">size =</span> n, <span class="dt">prob =</span> truth)</a>
<a class="sourceLine" id="cb2-14" title="14"></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#add Tulap noise to the original </span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#perform statistical testing on this data</span></a>
<a class="sourceLine" id="cb2-17" title="17">Z =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(X))</a>
<a class="sourceLine" id="cb2-18" title="18">Z =<span class="st"> </span>X <span class="op">+</span><span class="st"> </span><span class="kw">rtulap</span>(<span class="dt">n =</span> reps, <span class="dt">m =</span> <span class="dv">0</span>, <span class="dt">b =</span> b, <span class="dt">q =</span> q)</a></code></pre></div>
<p>The summary of the first 10 observations from <span class="math inline">\(\small X\)</span> and <span class="math inline">\(\small Z\)</span> is as follows:</p>
<table>
<tbody>
<tr class="odd">
<td align="left">X</td>
<td align="right">18.0</td>
<td align="right">11.0</td>
<td align="right">11.0</td>
<td align="right">11.00</td>
<td align="right">11.0</td>
<td align="right">15.0</td>
<td align="right">6.00</td>
<td align="right">8.00</td>
<td align="right">10.00</td>
<td align="right">14.0</td>
</tr>
<tr class="even">
<td align="left">Z</td>
<td align="right">18.4</td>
<td align="right">11.3</td>
<td align="right">10.5</td>
<td align="right">9.84</td>
<td align="right">12.8</td>
<td align="right">15.3</td>
<td align="right">9.87</td>
<td align="right">9.15</td>
<td align="right">7.04</td>
<td align="right">14.2</td>
</tr>
</tbody>
</table>
<p>The plot of the distribution of <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span> is as below: <img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="differentially-private-uniformly-most-powerful-tests-dp-ump" class="section level2">
<h2>Differentially Private Uniformly Most Powerful Tests (DP-UMP)</h2>
<div id="simple-and-one-sided-dp-ump-tests" class="section level3">
<h3>Simple and One-Sided DP-UMP Tests</h3>
<p>For example, to calculate the one-sided left DP-UMP test for <span class="math inline">\(\small H_0: \theta \le 0.4\)</span> against <span class="math inline">\(\small H_1: \theta &gt; 0.4\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">leftUMP =<span class="st"> </span><span class="kw">umpLeft</span>(<span class="dt">theta =</span> <span class="fl">0.4</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>, <span class="dt">epsilon =</span> ep, <span class="dt">delta =</span> de)</a>
<a class="sourceLine" id="cb3-2" title="2">rightUMP =<span class="st"> </span><span class="kw">umpRight</span>(<span class="dt">theta =</span> <span class="fl">0.4</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>, <span class="dt">epsilon =</span> ep, <span class="dt">delta =</span> de)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(\small \Phi(x)\)</span> represents the probability of rejecting the null hypothesis when observing <span class="math inline">\(X=x\)</span>.Unlike in the non-private setting where the test either results in rejection or acceptance, the randomness of the test in this case preserves privacy.</p>
<p>As expected, the power of the left UMP is 0.05.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">dbinom</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>),<span class="dt">size =</span> <span class="dv">10</span>,<span class="dt">prob =</span> truth)<span class="op">%*%</span>leftUMP</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; [1,] 0.05</span></a></code></pre></div>
</div>
<div id="unbiased-two-sided-dp-ump-tests" class="section level3">
<h3>Unbiased Two-Sided DP-UMP Tests</h3>
<p>Following up from the previous example, we calculate the unbiased two-sided DP-UMP for <span class="math inline">\(\small H_0: \theta= 0.4\)</span> against <span class="math inline">\(\small H_1: \theta \neq 0.4\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">twoUMP =<span class="st"> </span><span class="kw">UMPU</span>(<span class="dt">theta =</span> <span class="fl">0.4</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>, <span class="dt">epsilon =</span> ep, <span class="dt">delta =</span> de)</a></code></pre></div>
</div>
<div id="asymptotically-unbiased-two-sided-dp-ump-tests" class="section level3">
<h3>Asymptotically Unbiased Two-Sided DP-UMP Tests</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">numpu =<span class="st"> </span><span class="kw">umpuApprox</span>(<span class="dt">theta =</span> <span class="fl">0.4</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>, <span class="dt">epsilon =</span> ep, <span class="dt">delta =</span> de)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="p-values" class="section level2">
<h2>p-Values</h2>
<div id="ump-one-sided-p-values" class="section level3">
<h3>UMP One-Sided p-Values</h3>
<p>We continue to use the noisy data <span class="math inline">\(\small Z\)</span> to test the hypothesis <span class="math inline">\(\small H_0: \theta \le 0.5\)</span> against <span class="math inline">\(\small H_A: \theta &gt; 0.5\)</span>. As shown in the Data Simulation section, the true data <span class="math inline">\(\small X\)</span> is simulated under Binomial distristribution with <span class="math inline">\(\small \theta = 0.4\)</span>, which is unknown in the real setting, and the noisy data <span class="math inline">\(\small Z\)</span> is obtained by adding <span class="math inline">\(\small Tulap(0,b,q)\)</span> noise to <span class="math inline">\(\small X\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">pvalL =<span class="st"> </span><span class="kw">pvalLeft</span>(Z, <span class="dt">size =</span> n, <span class="dt">theta =</span> <span class="fl">0.5</span>, <span class="dt">b =</span> b, <span class="dt">q =</span> q)</a>
<a class="sourceLine" id="cb7-2" title="2">pvalR =<span class="st"> </span><span class="kw">pvalRight</span>(Z, <span class="dt">size =</span> n, <span class="dt">theta =</span> <span class="fl">0.5</span>, <span class="dt">b =</span> b, <span class="dt">q =</span> q)</a></code></pre></div>
<p>The p-values for the first 10 observations in <span class="math inline">\(\small Z\)</span> is summarized below:</p>
<table>
<tbody>
<tr class="odd">
<td align="left">Z</td>
<td align="right">18.42</td>
<td align="right">11.35</td>
<td align="right">10.51</td>
<td align="right">9.84</td>
<td align="right">12.83</td>
<td align="right">15.26</td>
<td align="right">9.87</td>
<td align="right">9.15</td>
<td align="right">7</td>
<td align="right">14.15</td>
</tr>
<tr class="even">
<td align="left">Left private p-value</td>
<td align="right">0.87</td>
<td align="right">0.11</td>
<td align="right">0.07</td>
<td align="right">0.04</td>
<td align="right">0.24</td>
<td align="right">0.53</td>
<td align="right">0.04</td>
<td align="right">0.03</td>
<td align="right">0</td>
<td align="right">0.39</td>
</tr>
<tr class="odd">
<td align="left">Right private p-value</td>
<td align="right">0.13</td>
<td align="right">0.89</td>
<td align="right">0.93</td>
<td align="right">0.96</td>
<td align="right">0.76</td>
<td align="right">0.47</td>
<td align="right">0.96</td>
<td align="right">0.97</td>
<td align="right">1</td>
<td align="right">0.61</td>
</tr>
</tbody>
</table>
<p>It is clear that with these p-values, we fail to reject the null hypothesis at level <span class="math inline">\(\small \alpha = 0.05\)</span> for all 10 observations. Since the true value <span class="math inline">\(\small \theta= 0.4\)</span> is in the null hypothesis, this confirms that the p-value has calibrated type I error.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">mean</span>(pvalR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; [1] 0.0045</span></a></code></pre></div>
</div>
<div id="asymptotically-unbiased-dp-p-values" class="section level3">
<h3>Asymptotically Unbiased DP p-Values</h3>
<p>Following up from the example above, we now test <span class="math inline">\(\small H_0:\theta = 0.5\)</span> versus <span class="math inline">\(\small H_A: \theta \neq 0.5\)</span> at level <span class="math inline">\(\small \alpha = 0.05\)</span>. This test is an approximation to the DP-UMPU, with calibrated type I error, but is only asymptotically unbiased.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">upval =<span class="st"> </span><span class="kw">pvalTwoSide</span>(Z, <span class="dt">size =</span> n, <span class="dt">theta =</span> <span class="fl">0.5</span>, <span class="dt">b =</span> b, <span class="dt">q =</span> q)</a></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">Z</td>
<td align="right">18.42</td>
<td align="right">11.35</td>
<td align="right">10.51</td>
<td align="right">9.84</td>
<td align="right">12.83</td>
<td align="right">15.26</td>
<td align="right">9.87</td>
<td align="right">9.15</td>
<td align="right">7.04</td>
<td align="right">14.15</td>
</tr>
<tr class="even">
<td align="left">P-Value</td>
<td align="right">0.25</td>
<td align="right">0.23</td>
<td align="right">0.13</td>
<td align="right">0.09</td>
<td align="right">0.47</td>
<td align="right">0.93</td>
<td align="right">0.09</td>
<td align="right">0.05</td>
<td align="right">0.01</td>
<td align="right">0.78</td>
</tr>
</tbody>
</table>
<p>Thus, we only have enough evidence to reject the null hypothesis at level <span class="math inline">\(\small \alpha = 0.05\)</span> with the 8th and 9th observation.</p>
</div>
<div id="comparing-private-and-non-private-p-values" class="section level3">
<h3>Comparing Private and Non-Private p-values</h3>
<p>We first calculate the non-private p-values using the first observation in the original data <span class="math inline">\(\small X\)</span>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">x =<span class="st"> </span>(X[<span class="dv">1</span>]<span class="op">/</span>n<span class="fl">-0.5</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="fl">0.5</span><span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">pR =<span class="st"> </span><span class="kw">pnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Then we add Tulap noise to the true data and calculate the private p-values 100,000 times. The distribution of private p-values compared to the non-private one is shown in the plot below. The randomness of private p-values helps preserve privacy.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">#calculate private pvalue of the first observation 100000 times</span></a>
<a class="sourceLine" id="cb11-2" title="2">tulap =<span class="st"> </span><span class="kw">rep</span>(X[<span class="dv">1</span>], <span class="dv">100000</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rtulap</span>(<span class="dt">n =</span> <span class="dv">100000</span>, <span class="dt">m =</span> <span class="dv">0</span>, <span class="dt">b =</span> b, <span class="dt">q =</span> q)</a>
<a class="sourceLine" id="cb11-3" title="3">ppval =<span class="st"> </span><span class="kw">pvalRight</span>(tulap, n, <span class="fl">0.5</span>, b, q)</a>
<a class="sourceLine" id="cb11-4" title="4"></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#plot the distriution of private p-values vs. non-private p-value</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="kw">hist</span>(ppval, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb11-7" title="7">     <span class="dt">main =</span> <span class="st">&quot;Distribution of Private vs Non-Private p-values for X[1]&quot;</span>, </a>
<a class="sourceLine" id="cb11-8" title="8">     <span class="dt">xlab =</span> <span class="st">&quot;p-values&quot;</span>)</a>
<a class="sourceLine" id="cb11-9" title="9"><span class="kw">abline</span>(<span class="dt">v=</span>pR, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb11-10" title="10"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb11-11" title="11">       <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">paste</span>(<span class="st">&quot;Non-private p-value =&quot;</span>, <span class="kw">round</span>(pR,<span class="dv">2</span>)), </a>
<a class="sourceLine" id="cb11-12" title="12">                <span class="kw">paste</span>(<span class="st">&quot;Avg private p-value =&quot;</span>, <span class="kw">round</span>(<span class="kw">mean</span>(ppval), <span class="dv">2</span>))), </a>
<a class="sourceLine" id="cb11-13" title="13">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd =</span> <span class="fl">1.5</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Similarly, we continue to compare private vs. non private two-sided p-values:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">#calculate non-private two-sided p-values</span></a>
<a class="sourceLine" id="cb12-2" title="2">p2 =<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">pnorm</span>(<span class="kw">abs</span>(x), <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">#calculate private two-sided p-values</span></a>
<a class="sourceLine" id="cb12-5" title="5">ppval2 =<span class="st"> </span><span class="kw">pvalTwoSide</span>(tulap, n, <span class="fl">0.5</span>, b, q)</a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">#plot and compare</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="kw">hist</span>(ppval2, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb12-9" title="9">     <span class="dt">main =</span> <span class="st">&quot;Distribution of Private vs Non-Private Two-Sided p-values for X[1]&quot;</span>, </a>
<a class="sourceLine" id="cb12-10" title="10">     <span class="dt">xlab =</span> <span class="st">&quot;p-values&quot;</span>, <span class="dt">probability =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-11" title="11"><span class="kw">abline</span>(<span class="dt">v=</span> p2, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb12-12" title="12"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb12-13" title="13">       <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">paste</span>(<span class="st">&quot;Non-private p-value =&quot;</span>, <span class="kw">round</span>(p2,<span class="dv">2</span>)), </a>
<a class="sourceLine" id="cb12-14" title="14">                <span class="kw">paste</span>(<span class="st">&quot;Avg private p-value =&quot;</span>, <span class="kw">round</span>(<span class="kw">mean</span>(ppval2), <span class="dv">2</span>))), </a>
<a class="sourceLine" id="cb12-15" title="15">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd =</span> <span class="fl">1.5</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="confidence-intervals" class="section level2">
<h2>Confidence Intervals</h2>
<div id="one-sided-confidence-intervals" class="section level3">
<h3>One-sided Confidence Intervals</h3>
<p>Here, we know the value of the first observation in X is 18 and its corresponding <span class="math inline">\(\small \theta\)</span> is 0.6. However, in the real setting, we only know the value of the first observation in the differentially private data Z is 18.4243, and we want to estimate the <span class="math inline">\(\small 95\%\)</span> confidence interval of <span class="math inline">\(\small \theta\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">CILower</span>(<span class="dt">alpha =</span> <span class="fl">0.05</span>, Z[<span class="dv">1</span>], <span class="dt">size =</span> n, <span class="dt">b =</span> b, <span class="dt">q =</span> q)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">#&gt; [1] 0.45</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw">CIUpper</span>(<span class="dt">alpha =</span> <span class="fl">0.05</span>, Z[<span class="dv">1</span>], <span class="dt">size =</span> n, <span class="dt">b =</span> b, <span class="dt">q =</span> q)</a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#&gt; [1] 0.76</span></a></code></pre></div>
<p>The upper and lower CI for <span class="math inline">\(\small \theta\)</span> at level <span class="math inline">\(\small \alpha=0.05\)</span> given the first observation of Z is <span class="math inline">\(\small(0.45,1)\)</span> and <span class="math inline">\(\small (0, 0.76)\)</span>, respectively. Similarly, we obtain the lower bounds of the one-sided confidence intervals from the first 10 observations from the data:</p>
<table>
<tbody>
<tr class="odd">
<td align="left">Z</td>
<td align="right">18.42</td>
<td align="right">11.35</td>
<td align="right">10.51</td>
<td align="right">9.84</td>
<td align="right">12.83</td>
<td align="right">15.26</td>
<td align="right">9.87</td>
<td align="right">9.15</td>
<td align="right">7.04</td>
<td align="right">14.15</td>
</tr>
<tr class="even">
<td align="left">Lower Bound</td>
<td align="right">0.45</td>
<td align="right">0.23</td>
<td align="right">0.21</td>
<td align="right">0.19</td>
<td align="right">0.27</td>
<td align="right">0.35</td>
<td align="right">0.19</td>
<td align="right">0.17</td>
<td align="right">0.11</td>
<td align="right">0.31</td>
</tr>
<tr class="odd">
<td align="left">Upper Bound</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
</div>
<div id="asymptotically-unbiased-two-sided-confidence-intervals" class="section level3">
<h3>Asymptotically Unbiased Two-sided Confidence Intervals</h3>
<p><code>CINearlyUnbiased()</code> computes the asymptotically unbiased two-sided confidence interval for <span class="math inline">\(\small \theta\)</span> with specified level of <span class="math inline">\(\small \alpha\)</span>. This confidence interval is typically more accurate than the simple two-sided confidence interval. For example, to calculate the two-sided confidence interval of <span class="math inline">\(\small \theta\)</span> of the first observation in Z:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">CITwoSide</span>(<span class="dt">alpha =</span> <span class="fl">0.05</span>, Z[<span class="dv">1</span>], <span class="dt">size =</span> n, <span class="dt">b =</span> b, <span class="dt">q =</span> q)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">#&gt; [1] 0.42 0.78</span></a></code></pre></div>
<p>Similarly, we obtain the <span class="math inline">\(\small 95\%\)</span> two-sided confidence intervals for the first 10 observations in Z:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">CITwoUpper =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(Z))</a>
<a class="sourceLine" id="cb15-2" title="2">CITwoLower =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(Z))</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Z)){</a>
<a class="sourceLine" id="cb15-4" title="4">  CITwoLower[i] =<span class="st"> </span><span class="kw">CITwoSide</span>(<span class="dt">alpha =</span> <span class="fl">0.05</span>, Z[i], <span class="dt">size =</span> n, <span class="dt">b =</span> b, <span class="dt">q =</span> q)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb15-5" title="5">  CITwoUpper[i] =<span class="st"> </span><span class="kw">CITwoSide</span>(<span class="dt">alpha =</span> <span class="fl">0.05</span>, Z[i], <span class="dt">size =</span> n, <span class="dt">b =</span> b, <span class="dt">q =</span> q)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb15-6" title="6">}</a></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">Z</td>
<td align="right">18.42</td>
<td align="right">11.35</td>
<td align="right">10.51</td>
<td align="right">9.84</td>
<td align="right">12.83</td>
<td align="right">15.26</td>
<td align="right">9.87</td>
<td align="right">9.15</td>
<td align="right">7.04</td>
<td align="right">14.15</td>
</tr>
<tr class="even">
<td align="left">Lower Bound</td>
<td align="right">0.42</td>
<td align="right">0.21</td>
<td align="right">0.19</td>
<td align="right">0.17</td>
<td align="right">0.25</td>
<td align="right">0.32</td>
<td align="right">0.17</td>
<td align="right">0.15</td>
<td align="right">0.10</td>
<td align="right">0.29</td>
</tr>
<tr class="odd">
<td align="left">Upper Bound</td>
<td align="right">0.78</td>
<td align="right">0.57</td>
<td align="right">0.55</td>
<td align="right">0.52</td>
<td align="right">0.62</td>
<td align="right">0.69</td>
<td align="right">0.53</td>
<td align="right">0.50</td>
<td align="right">0.43</td>
<td align="right">0.66</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="comparing-differentially-private-and-non-private-population-proportion-test" class="section level2">
<h2>Comparing Differentially Private and Non-Private Population Proportion Test</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co">#private test on noisy sample Z[1]</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">dpPropTest</span>(Z[<span class="dv">1</span>], <span class="dt">size =</span> n, <span class="dt">theta =</span> <span class="fl">0.5</span>, <span class="dt">b =</span> b, <span class="dt">q =</span> q, <span class="st">&quot;greater&quot;</span>, <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#&gt;                  Ha: True theta greater than 0.5</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#&gt; Data                                       18.42</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co">#&gt; Size                                       30.00</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co">#&gt; Sample Estimates                            0.61</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co">#&gt; p-value                                     0.13</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co">#&gt; Lower Limit                                 0.45</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">#&gt; Upper Limit                                 1.00</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">#non-private test on real data X[1]</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="kw">prop.test</span>(X[<span class="dv">1</span>], n, <span class="dt">p =</span> <span class="fl">0.5</span>, <span class="st">&quot;greater&quot;</span>, <span class="dt">conf.level =</span> <span class="fl">0.95</span>, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co">#&gt;  1-sample proportions test without continuity correction</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb16-15" title="15"><span class="co">#&gt; data:  X[1] out of n, null probability 0.5</span></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="co">#&gt; X-squared = 1, df = 1, p-value = 0.1</span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="co">#&gt; alternative hypothesis: true p is greater than 0.5</span></a>
<a class="sourceLine" id="cb16-18" title="18"><span class="co">#&gt; 95 percent confidence interval:</span></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="co">#&gt;  0.45 1.00</span></a>
<a class="sourceLine" id="cb16-20" title="20"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb16-21" title="21"><span class="co">#&gt;   p </span></a>
<a class="sourceLine" id="cb16-22" title="22"><span class="co">#&gt; 0.6</span></a></code></pre></div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Awan, Jordan Alexander, and Aleksandra Slavkovic. 2020. “Differentially Private Inference for Binomial Data”. Journal of Privacy and Confidentiality 10 (1). <a href="https://doi.org/10.29012/jpc.725" class="uri">https://doi.org/10.29012/jpc.725</a>.</p>
<p>Awan, Jordan, and Aleksandra Slavković. “Differentially private uniformly most powerful tests for binomial data.” In Advances in Neural Information Processing Systems, pp. 4208-4218. 2018.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
